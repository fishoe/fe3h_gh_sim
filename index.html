<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>온실 재배 시뮬레이터</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <script>
        const base_data = {
            method : [
                ["없음",0],
                ["마력을 주입한다",0],
                ["아미드 물을 뿌린다",300],
                ["솎아낸다",500],
                ["비료를 뿌린다",1000],
                ["칼레도니아 흙을 뿌린다",1500],
                ["천마의 은혜를 뿌린다",2000]
            ],
            score_table : [90,80,60,40,20],
            score_values:[
                [3,3,7,20],
                [3,8,2,15],
                [2,4,6,10],
                [2,7,3,5],
                [1,2,8,3],
                [1,7,3,1]
            ],
            seed_name:['풀 씨앗', '서방 포드라산 씨앗', '뿌리채소 씨앗', '야채 씨앗', '북방 포드라산 씨앗', '모르피스 자두 씨앗', '남방 포드라산 씨앗', '모르피스산 씨앗', '북방 상추 씨앗', '보아뱀 과일 씨앗', '알비네산 씨앗', '동방 포드라산 씨앗', '안젤리카 씨앗', '과일 씨앗', '빨간 꽃 씨앗', '하얀 꽃 씨앗', '파란 꽃 씨앗', '보라색 꽃 씨앗', '노란색 꽃 씨앗', '초록색 꽃 씨앗', '하늘색 꽃 씨앗'],
            seed_data: { "풀 씨앗": { "1": { "하위": ["잡초", "잡초", "양파", "풀 씨앗", "풀 씨앗"], "상위": ["풀 씨앗", "풀 씨앗", "순무", "양배추", "복숭아"] }, "도핑": "바위 우엉", "2": { "하위": ["풀 씨앗", "알비네베리", "순무", "순무", "과일 씨앗"], "상위": ["풀 씨앗", "복숭아", "순무", "노란색 꽃 씨앗", "과일 씨앗"] }, "3": { "하위": ["풀 씨앗", "당근", "북방 포드라산 씨앗", "병아리콩", "양배추"], "상위": ["서방 포드라산 씨앗", "토마토", "북방 포드라산 씨앗", "수선화", "병아리콩"] }, "희귀도": "1", "등급": "27", "스탯": "힘" }, "서방 포드라산 씨앗": { "1": { "하위": ["자나드 열매", "자나드 열매", "당근", "서방 포드라산 씨앗", "서방 포드라산 씨앗"], "상위": ["서방 포드라산 씨앗", "노아 열매", "병아리콩", "양배추", "뿌리채소 씨앗"] }, "도핑": "생명의 나무 열매", "2": { "하위": ["서방 포드라산 씨앗", "노아 열매", "노아 열매", "복숭아", "야채 씨앗"], "상위": ["서방 포드라산 씨앗", "노아 열매", "토마토", "초록색 꽃 씨앗", "알비네베리"] }, "3": { "하위": ["서방 포드라산 씨앗", "노아 열매", "남방 포드라산 씨앗", "파란 꽃 씨앗", "당근"], "상위": ["뿌리채소 씨앗", "노아 열매", "남방 포드라산 씨앗", "해바라기", "양파"] }, "희귀도": "1", "등급": "9", "스탯": "체력" }, "뿌리채소 씨앗": { "1": { "하위": ["잡초", "잡초", "병아리콩", "뿌리채소 씨앗", "뿌리채소 씨앗"], "상위": ["뿌리채소 씨앗", "알비네베리", "토마토", "양배추", "양배추"] }, "도핑": "암브로시아", "2": { "하위": ["뿌리채소 씨앗", "당근", "양배추", "복숭아", "북방 포드라산 씨앗"], "상위": ["뿌리채소 씨앗", "노아 열매", "양배추", "하늘색 꽃 씨앗", "북방 포드라산 씨앗"] }, "3": { "하위": ["뿌리채소 씨앗", "토마토", "모르피스산 씨앗", "보라색 꽃 씨앗", "병아리콩"], "상위": ["파란 꽃 씨앗", "복숭아", "모르피스산 씨앗", "제비꽃", "순무"] }, "희귀도": "1", "등급": "49", "스탯": "수비" }, "야채 씨앗": { "1": { "하위": ["시든 야채", "시든 야채", "병아리콩", "야채 씨앗", "야채 씨앗"], "상위": ["시든 야채", "병아리콩", "양파", "복숭아", "순무"] }, "도핑": "하얀 베로나", "2": { "하위": ["야채 씨앗", "양파", "토마토", "순무", "풀 씨앗"], "상위": ["야채 씨앗", "복숭아", "양파", "보라색 꽃 씨앗", "노아 열매"] }, "3": { "하위": ["노아 열매", "양파", "알비네산 씨앗", "마그드레드 버찌", "당근"], "상위": ["북방 상추 씨앗", "베로나", "알비네산 씨앗", "은방울꽃", "양파"] }, "희귀도": "1", "등급": "33", "스탯": "마방" }, "북방 포드라산 씨앗": { "1": { "하위": ["시든 야채", "시든 야채", "양파", "북방 포드라산 씨앗", "북방 포드라산 씨앗"], "상위": ["북방 포드라산 씨앗", "토마토", "병아리콩", "과일 씨앗", "과일 씨앗"] }, "도핑": "황금 사과", "2": { "하위": ["북방 포드라산 씨앗", "당근", "노아 열매", "과일 씨앗", "뿌리채소 씨앗"], "상위": ["북방 포드라산 씨앗", "복숭아", "노아 열매", "노란색 꽃 씨앗", "알비네베리"] }, "3": { "하위": ["북방 포드라산 씨앗", "모르피스 자두", "모르피스산 씨앗", "하얀 꽃 씨앗", "병아리콩"], "상위": ["남방 포드라산 씨앗", "병아리콩", "모르피스산 씨앗", "장미", "순무"] }, "희귀도": "2", "등급": "53", "스탯": "매력" }, "모르피스 자두 씨앗": { "1": { "하위": ["자나드 열매", "자나드 열매", "복숭아", "노아 열매", "모르피스 자두 씨앗"], "상위": ["자나드 열매", "모르피스 자두 씨앗", "모르피스 자두", "모르피스 자두", "복숭아"] }, "도핑": "연옥의 석류", "2": { "하위": ["모르피스 자두 씨앗", "복숭아", "노아 열매", "모르피스 자두", "모르피스 자두"], "상위": ["모르피스 자두 씨앗", "토마토", "모르피스 자두", "모르피스 자두", "알비네산 씨앗"] }, "3": { "하위": ["모르피스 자두", "모르피스 자두", "동방 포드라산 씨앗", "보라색 꽃 씨앗", "순무"], "상위": ["북방 상추 씨앗", "마그드레드 버찌", "동방 포드라산 씨앗", "물망초", "자나드 보과"] }, "희귀도": "4", "등급": "18", "스탯": "기술" }, "남방 포드라산 씨앗": { "1": { "하위": ["잡초", "잡초", "당근", "남방 포드라산 씨앗", "남방 포드라산 씨앗"], "상위": ["남방 포드라산 씨앗", "순무", "복숭아", "양배추", "서방 포드라산 씨앗"] }, "도핑": "상급 마력초", "2": { "하위": ["남방 포드라산 씨앗", "순무", "양배추", "복숭아", "북방 포드라산 씨앗"], "상위": ["남방 포드라산 씨앗", "순무", "베로나", "빨간 꽃 씨앗", "마그드레드 버찌"] }, "3": { "하위": ["남방 포드라산 씨앗", "순무", "모르피스 자두", "노란색 꽃 씨앗", "마그드레드 버찌"], "상위": ["베로나", "복숭아", "모르피스 자두", "안개꽃", "병아리콩"] }, "희귀도": "2", "등급": "37", "스탯": "마력" }, "모르피스산 씨앗": { "1": { "하위": ["잡초", "잡초", "순무", "모르피스산 씨앗", "순무"], "상위": ["모르피스산 씨앗", "모르피스산 씨앗", "당근", "순무", "과일 씨앗"] }, "도핑": "연옥의 석류", "2": { "하위": ["모르피스산 씨앗", "모르피스산 씨앗", "복숭아", "병아리콩", "야채 씨앗"], "상위": ["모르피스산 씨앗", "당근", "순무", "하얀 꽃 씨앗", "야채 씨앗"] }, "3": { "하위": ["모르피스산 씨앗", "알비네베리", "토마토", "초록색 꽃 씨앗", "복숭아"], "상위": ["마그드레드 버찌", "당근", "토마토", "아네모네", "양파"] }, "희귀도": "2", "등급": "23", "스탯": "기술" }, "북방 상추 씨앗": { "1": { "하위": ["시든 야채", "베로나", "당근", "북방 상추 씨앗", "북방 상추 씨앗"], "상위": ["시든 야채", "북방 상추 씨앗", "병아리콩", "북방 상추", "북방 상추"] }, "도핑": "준족의 당근", "2": { "하위": ["북방 상추 씨앗", "당근", "북방 상추", "북방 상추", "북방 상추"], "상위": ["북방 상추 씨앗", "북방 상추", "마그드레드 버찌", "베로나", "알비네베리"] }, "3": { "하위": ["북방 상추", "북방 상추", "안젤리카 씨앗", "하늘색 꽃 씨앗", "마그드레드 버찌"], "상위": ["연옥초", "안젤리카", "안젤리카 씨앗", "수선화", "순무"] }, "희귀도": "4", "등급": "3", "스탯": "속도" }, "보아뱀 과일 씨앗": { "1": { "하위": ["잡초", "잡초", "복숭아", "보아뱀 과일 씨앗", "보아뱀 과일 씨앗"], "상위": ["잡초", "보아뱀 과일 씨앗", "자나드 열매", "보아뱀 과일", "보아뱀 과일"] }, "도핑": "기적의 콩", "2": { "하위": ["보아뱀 과일 씨앗", "복숭아", "보아뱀 과일", "보아뱀 과일", "보아뱀 과일"], "상위": ["보아뱀 과일 씨앗", "보아뱀 과일", "보아뱀 과일", "보아뱀 과일", "안젤리카 씨앗"] }, "3": { "하위": ["보아뱀 과일", "보아뱀 과일", "자나드 보과", "빨간 꽃 씨앗", "양파"], "상위": ["안젤리카 씨앗", "자나드 보과", "풀 씨앗", "해바라기", "양배추"] }, "희귀도": "5", "등급": "31", "스탯": "행운" }, "알비네산 씨앗": { "1": { "하위": ["자나드 열매", "자나드 열매", "복숭아", "알비네산 씨앗", "알비네산 씨앗"], "상위": ["알비네산 씨앗", "병아리콩", "복숭아", "알비네베리", "과일 씨앗"] }, "도핑": "황금 사과", "2": { "하위": ["알비네산 씨앗", "알비네산 씨앗", "복숭아", "알비네베리", "뿌리채소 씨앗"], "상위": ["알비네산 씨앗", "당근", "복숭아", "노란색 꽃 씨앗", "뿌리채소 씨앗"] }, "3": { "하위": ["알비네산 씨앗", "당근", "토마토", "하얀 꽃 씨앗", "순무"], "상위": ["알비네베리", "병아리콩", "토마토", "제비꽃", "당근"] }, "희귀도": "2", "등급": "20", "스탯": "매력" }, "동방 포드라산 씨앗": { "1": { "하위": ["잡초", "잡초", "토마토", "동방 포드라산 씨앗", "동방 포드라산 씨앗"], "상위": ["동방 포드라산 씨앗", "베로나", "양파", "복숭아", "양파"] }, "도핑": "암브로시아", "2": { "하위": ["동방 포드라산 씨앗", "동방 포드라산 씨앗", "양파", "양파", "모르피스산 씨앗"], "상위": ["동방 포드라산 씨앗", "복숭아", "양파", "초록색 꽃 씨앗", "모르피스산 씨앗"] }, "3": { "하위": ["동방 포드라산 씨앗", "토마토", "북방 상추 씨앗", "파란 꽃 씨앗", "양배추"], "상위": ["알비네베리", "베로나", "북방 상추", "벌레잡이풀", "병아리콩"] }, "희귀도": "2", "등급": "42", "스탯": "수비" }, "안젤리카 씨앗": { "1": { "하위": ["잡초", "잡초", "토마토", "안젤리카 씨앗", "안젤리카 씨앗"], "상위": ["잡초", "안젤리카 씨앗", "안젤리카", "북방 상추", "안젤리카"] }, "도핑": "바위 우엉", "2": { "하위": ["안젤리카 씨앗", "안젤리카", "마그드레드 버찌", "안젤리카", "안젤리카"], "상위": ["안젤리카 씨앗", "안젤리카", "안젤리카", "안젤리카", "모르피스 자두 씨앗"] }, "3": { "하위": ["안젤리카", "안젤리카", "연옥초", "노란색 꽃 씨앗", "병아리콩"], "상위": ["보아뱀 과일 씨앗", "연옥초", "서방 포드라산 씨앗", "백합", "순무"] }, "희귀도": "5", "등급": "34", "스탯": "힘" }, "과일 씨앗": { "1": { "하위": ["자나드 열매", "자나드 열매", "복숭아", "과일 씨앗", "과일 씨앗"], "상위": ["과일 씨앗", "북방 포드라산 씨앗", "북방 포드라산 씨앗", "복숭아", "뿌리채소 씨앗"] }, "도핑": "기적의 콩", "2": { "하위": ["과일 씨앗", "북방 포드라산 씨앗", "복숭아", "알비네베리", "뿌리채소 씨앗"], "상위": ["과일 씨앗", "북방 포드라산 씨앗", "복숭아", "하얀 꽃 씨앗", "모르피스 자두"] }, "3": { "하위": ["과일 씨앗", "북방 포드라산 씨앗", "동방 포드라산 씨앗", "초록색 꽃 씨앗", "양파"], "상위": ["북방 포드라산 씨앗", "노아 열매", "동방 포드라산 씨앗", "은방울꽃", "양배추"] }, "희귀도": "1", "등급": "44", "스탯": "행운" }, "빨간 꽃 씨앗": { "1": { "하위": ["잡초", "잡초", "잡초", "카네이션", "빨간 꽃 씨앗"], "상위": ["잡초", "빨간 꽃 씨앗", "노란색 꽃 씨앗", "장미", "카네이션"] }, "도핑": "하얀 베로나", "2": { "하위": ["장미", "장미", "카네이션", "백합", "하얀 꽃 씨앗"], "상위": ["수선화", "라벤더", "노란색 꽃 씨앗", "보라색 꽃 씨앗", "파란 꽃 씨앗"] }, "3": { "하위": ["수선화", "양파", "파란 꽃 씨앗", "알비네산 씨앗", "장미"], "상위": ["장미", "풀 씨앗", "알비네산 씨앗", "북방 상추", "마그드레드 버찌"] }, "희귀도": "3", "등급": "24", "스탯": "마방" }, "하얀 꽃 씨앗": { "1": { "하위": ["잡초", "잡초", "잡초", "안개꽃", "하얀 꽃 씨앗"], "상위": ["잡초", "하얀 꽃 씨앗", "초록색 꽃 씨앗", "수선화", "안개꽃"] }, "도핑": "황금 사과", "2": { "하위": ["수선화", "안개꽃", "백합", "은방울꽃", "파란 꽃 씨앗"], "상위": ["해바라기", "아네모네", "초록색 꽃 씨앗", "노란색 꽃 씨앗", "보라색 꽃 씨앗"] }, "3": { "하위": ["해바라기", "남방 포드라산 씨앗", "보라색 꽃 씨앗", "순무", "수선화"], "상위": ["수선화", "야채 씨앗", "서방 포드라산 씨앗", "모르피스 자두 씨앗", "보아뱀 과일"] }, "희귀도": "3", "등급": "5", "스탯": "매력" }, "파란 꽃 씨앗": { "1": { "하위": ["잡초", "잡초", "잡초", "물망초", "파란 꽃 씨앗"], "상위": ["잡초", "파란 꽃 씨앗", "하늘색 꽃 씨앗.", "아네모네", "물망초"] }, "도핑": "생명의 나무 열매", "2": { "하위": ["물망초", "물망초", "아네모네", "장미", "보라색 꽃 씨앗"], "상위": ["제비꽃", "은방울꽃", "하늘색 꽃 씨앗", "초록색 꽃 씨앗", "노란색 꽃 씨앗"] }, "3": { "하위": ["제비꽃", "병아리콩", "노란색 꽃 씨앗", "동방 포드라산 씨앗", "물망초"], "상위": ["물망초", "뿌리채소 씨앗", "동방 포드라산 씨앗", "모르피스 자두 씨앗", "북방 상추"] }, "희귀도": "3", "등급": "38", "스탯": "체력" }, "보라색 꽃 씨앗": { "1": { "하위": ["잡초", "잡초", "잡초", "라벤더", "보라색 꽃 씨앗"], "상위": ["잡초", "보라색 꽃 씨앗", "빨간 꽃 씨앗", "제비꽃", "라벤더"] }, "도핑": "바위 우엉", "2": { "하위": ["제비꽃", "장미", "라벤더", "물망초", "노란색 꽃 씨앗"], "상위": ["벌레잡이풀", "안개꽃", "빨간 꽃 씨앗", "하늘색 꽃 씨앗", "초록색 꽃 씨앗"] }, "3": { "하위": ["벌레잡이풀", "양배추", "초록색 꽃 씨앗", "풀 씨앗", "제비꽃"], "상위": ["라벤더", "서방 포드라산 씨앗", "모르피스산 씨앗", "동방 포드라산 씨앗", "알비네베리"] }, "희귀도": "3", "등급": "16", "스탯": "힘" }, "노란색 꽃 씨앗": { "1": { "하위": ["잡초", "잡초", "잡초", "해바라기", "노란색 꽃 씨앗"], "상위": ["잡초", "노란색 꽃 씨앗", "하얀 꽃 씨앗", "해바라기", "해바라기"] }, "도핑": "상급 마력초", "2": { "하위": ["해바라기", "아네모네", "수선화", "백합", "초록색 꽃 씨앗"], "상위": ["카네이션", "장미", "하얀 꽃 씨앗", "빨간 꽃 씨앗", "하늘색 꽃 씨앗"] }, "3": { "하위": ["카네이션", "모르피스산 씨앗", "하늘색 꽃 씨앗", "양파", "해바라기"], "상위": ["해바라기", "북방 포드라산 씨앗", "남방 포드라산 씨앗", "보아뱀 과일 씨앗", "과일 씨앗"] }, "희귀도": "3", "등급": "55", "스탯": "마력" }, "초록색 꽃 씨앗": { "1": { "하위": ["잡초", "잡초", "잡초", "벌레잡이풀", "초록색 꽃 씨앗"], "상위": ["잡초", "초록색 꽃 씨앗", "파란 꽃 씨앗", "벌레잡이풀", "벌레잡이풀"] }, "도핑": "연옥의 석류", "2": { "하위": ["벌레잡이풀", "벌레잡이풀", "장미", "장미", "하늘색 꽃 씨앗"], "상위": ["백합", "제비꽃", "파란 꽃 씨앗", "하얀 꽃 씨앗", "빨간 꽃 씨앗"] }, "3": { "하위": ["백합", "자나드 열매", "빨간 꽃 씨앗", "양배추", "벌레잡이풀"], "상위": ["벌레잡이풀", "뿌리채소 씨앗", "동방 포드라산 씨앗", "토마토", "모르피스 자두"] }, "희귀도": "3", "등급": "10", "스탯": "기술" }, "하늘색 꽃 씨앗": { "1": { "하위": ["잡초", "잡초", "잡초", "카네이션", "하늘색 꽃 씨앗"], "상위": ["잡초", "하늘색 꽃 씨앗", "보라색 꽃 씨앗", "카네이션", "카네이션"] }, "도핑": "준족의 당근", "2": { "하위": ["아네모네", "아네모네", "물망초", "장미", "빨간 꽃 씨앗"], "상위": ["은방울꽃", "벌레잡이풀", "보라색 꽃 씨앗", "파란 꽃 씨앗", "하얀 꽃 씨앗"] }, "3": { "하위": ["은방울꽃", "북방 포드라산 씨앗", "하얀 꽃 씨앗", "순무", "아네모네"], "상위": ["물망초", "과일 씨앗", "북방 포드라산 씨앗", "토마토", "베로나"] }, "희귀도": "3", "등급": "1", "스탯": "속도" } }
        }

        function create_seed_selector(select_tag){
            let seed_name_list = base_data["seed_name"];
            for(let i=0;i<seed_name_list.length;i++){
                let option = document.createElement("option");
                option.value = seed_name_list[i];
                option.text = seed_name_list[i];
                select_tag.add(option);
            }
        }
        
        function calculate(){

            let div_res = document.getElementById("result");
            div_res.innerText = "";
            
            let seed_list = document.getElementById("seed_list");
            let seed_items = seed_list.getElementsByTagName("li");
            let seed_data = base_data.seed_data;
            let seed_array = [];
            
            for(let i=0;i<seed_items.length;i++){
                let n_seed = Number(seed_items[i].getElementsByTagName("input")[0].value);
                let seed = seed_items[i].getElementsByTagName("select")[0].value;
                for(let j=0;j<n_seed;j++){
                    seed_array.push(seed);
                }
            }
            if(seed_array.length>5 || seed_array.length < 1){
                div_res.innerText = `씨앗 개수 오류(씨앗 갯수 : ${seed_array.length})`;
                return;
            }else {
                let score = 0;
                seed_array.sort();
                
                let total_grade = 0;
                let total_rare = 0;

                let method_selector = document.getElementById("method");
                let method_value = method_selector.value;
                let seed_map = {}

                for(let i=0;i<seed_array.length;i++){
                    seed_name = seed_array[i]
                    total_grade += Number(seed_data[seed_name]["등급"])
                    total_rare += Number(seed_data[seed_name]["희귀도"])
                    if (seed_name in seed_map) {
                        seed_map[seed_name] += 1;
                    }else {
                        seed_map[seed_name] = 1 ;
                    }
                }

                let score_a = (12 - (total_grade % 12)) * 5;
                let score_b = parseInt((total_rare / 5) * 4);
                let score_c = method_value * 2 + 8;

                score = score_a + score_b + score_c ;
                
                let score_table = base_data.score_table;
                let grade = 5;

                for(let i=0;i<score_table.length;i++){
                    if(score > score_table[i]){
                        grade = i;
                        break;
                    }
                }

                score_values = base_data.score_values[grade];

                console.log(score_values);

                let prob_html = "";

                booster_map = {};

                cultivation_tier = 6 - grade;
                total_boost_prob = 0;

                booster_prob_base = score_values[3] + seed_array.length * 6 + method_value*5;
                for(i in seed_map){
                    seed_rare_prob = (Number(seed_data[i]["희귀도"]) - 1) * 5;
                    current_seed_prob = seed_rare_prob + booster_prob_base;
                    boost_name = seed_data[i]["도핑"];
                    prob_text = `${boost_name} : ${ current_seed_prob}`;
                    // console.log(current_seed_prob);
                    if (boost_name in booster_map){
                        booster_map[boost_name] += seed_map[i] * current_seed_prob;
                    }else {
                        booster_map[boost_name] = seed_map[i] * current_seed_prob;
                    }
                    total_boost_prob += seed_map[i] * current_seed_prob;
                }
                
                total_boost_prob/=seed_array.length;
                // console.log(booster_map);                
                div_res.innerHTML = `총 스코어는 ${score}<br>등급은 ${grade}<br>`;
                div_res.innerHTML += `표기 등급은 ${score_values[0]}<br>`;
                div_res.innerHTML += `도핑템 등장 확률은${total_boost_prob}<br>`;
                for(i in booster_map){
                    booster_map[i] /= seed_array.length;
                    div_res.innerHTML += `${i} : ${booster_map[i]}<br>`;
                }
                return;
            }
        }

        window.onload=()=>{
            let seed_list = document.getElementById("seed_list"); 
            let method_selector = document.getElementById("method");
            let method_data = base_data["method"];

            for(let i=0;i<5;i++){
                let list_item = document.createElement("li");
                let select = document.createElement("select");
                create_seed_selector(select);
                list_item.appendChild(select);
                let number = document.createElement("input")
                number.type="number"
                number.min = 0;
                number.max = 5;
                number.value = 0;
                list_item.appendChild(number);
                seed_list.append(list_item);
            }

            for(let i = 0;i < method_data.length ; i++){
                let option = document.createElement("option");
                option.value = i;
                option.text = method_data[i][0];
                method_selector.add(option);    
            }
        };
    </script>
</head>
<body>
    <div>
        <p>씨앗</p>
        <ul id="seed_list">
        </ul>
        <p>육성</p><select id="method"></select>
        <button onclick="calculate()">계산</button>
    </div>
    <div id="result">

    </div>
</body>
</html>
